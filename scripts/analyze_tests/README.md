# Analyze Tests
## Overview
Scripts under this folder are used to extract assertion related identifiers (e.g. assertTrue) from the trigger tests.  

Notice the manual processes in this experiment is to further promote the precision and accuracy of the result. The automatically generated result can also be used in the later experiments.  

## Usage
### Extract identifiers from Junit lib
Script `extract_junit_asserts.py` can extract assertion related identifiers from official Junit 3.8 and Junit 4 source code (specifically, from the class Assert).
`python3 extract_junit_asserts.py`  

The output is `./names/junit` (a text file in which every line is a assertion related identifier).  

### Analyze the trigger tests
Script `analyze_ver_5.py` is the analysis process. Name ver\_5 indicates there are other versions before it is developed. Actually, the result we used in the later experiments is combined from results of whole versions. We select version 5 there because it is good in both precision and accuracy.  
`python3 analyze_ver_5.py <path_to_metadata_json_file> <path_to_bug_ids> <path_to_bugs>`  

For actual arguments please check the previous experiments and ensure they are done.  

The paths of files/directories in arguments can be specify in the experiment `construct_database` (by default, they are `../construct_database/d4j_export/database.json`, `../construct_database/2toMore` and `/tmp/` respectively).  

The output is `./logs/log5` which contains the runtime log and the identifiers filtered by the script. However, the result (a identifier list used in the later experiments) should be manually checked and writena (the script only filters all suspicious identifiers and it may make mistakes).  

### Analyze stack trace of the trigger tests
Script `analyze_triggers.py` further extracts identifiers that may cause test failed (even they are not an assertion).  
`python3 analyze_triggers.py <path_to_bug_ids> [<path_to_defects4j>]`  

The output is a log file `./names/tryTrigger` which is similar to file `./logs/log5` that we should check its result manually.  

### Generate identifiers list
Scripts and text files under folder `./names` are for manually checking and identifiers list generation. 

The text files contain the manual analysis from the previous logs generated by scripts. The process is to check every identifier in the logs if it is a method that may cause test failed, if so, add it to one of the text files.  

The scripts are written for partially automate the manual analysis process.  

To generate the identifiers list, run script `./names/table.py` which generate a text file `./names/table` that can be used in the later experiments. However, it is recommanded to double check the file content.  

## Reproduce the experiments
The whole process takes about 30 seconds.  

* Ensure you have finished the previous experiment `construct_database`  

* Run script `./run.sh` or refer to the usage section to execute scripts   
